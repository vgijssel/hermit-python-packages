# Task for Linux amd64 builds
linux_amd64_task:
  name: Linux amd64 Build
  environment:
    GITHUB_TOKEN: ENCRYPTED[!590524e454536ddfaa86e590caf07ac4d13018ad4c15cfc6795b203b4651d798683dfe230bc65389c750e1f75d1f3a32!]
  container:
    image: ubuntu:24.04
    cpu: 2
    memory: 4G
  setup_script:
    - apt-get update
    - apt-get install -y curl git build-essential
    # Setup direnv
    - curl -sfL https://direnv.net/install.sh | bash
    - echo 'eval "$(direnv hook bash)"' >> ~/.bashrc
    - source ~/.bashrc
    - direnv allow .
  build_script:
    - eval $(direnv exec / direnv export bash)
    - task pex:build

# Task for Linux arm64 builds
linux_arm64_task:
  name: Linux arm64 Build
  environment:
    GITHUB_TOKEN: ENCRYPTED[!590524e454536ddfaa86e590caf07ac4d13018ad4c15cfc6795b203b4651d798683dfe230bc65389c750e1f75d1f3a32!]
  arm_container:
    image: ubuntu:24.04
    cpu: 2
    memory: 4G
  setup_script:
    - apt-get update
    - apt-get install -y curl git build-essential
    # Setup direnv
    - curl -sfL https://direnv.net/install.sh | bash
    - echo 'eval "$(direnv hook bash)"' >> ~/.bashrc
    - source ~/.bashrc
    - direnv allow .
  build_script:
    - eval $(direnv exec / direnv export bash)
    - task pex:build
